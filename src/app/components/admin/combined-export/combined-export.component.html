<!-- Combined Export Component HTML -->
<div class="combined-export-container">
    <!-- Header Section -->
    <header class="header-section">
        <div class="header-top">
            <div class="title-section">
                <div class="title-content">
                    <span class="title-icon">üìäüí∞</span>
                    <div class="title-wrapper">
                        <h1 class="title-text">Export Financier Combin√©</h1>
                        <p class="subtitle-text">Exportez une analyse financi√®re compl√®te combinant les revenus et les
                            d√©penses</p>
                    </div>
                </div>
                <div class="academic-year-badge">
                    <span class="year-label">Ann√©e Acad√©mique</span>
                    <span class="year-value">{{ currentAcademicYear }}</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Filters Section -->
    <section class="filters-section">
        <div class="filters-header">
            <h3 class="filters-title">
                <span class="filters-icon">üîç</span>
                Filtres d'Export
            </h3>
            <button class="btn-clear-filters" (click)="clearFilters()" type="button">
                <span class="clear-icon">üóëÔ∏è</span>
                Effacer les filtres
            </button>
        </div>

        <div class="filters-grid">
            <!-- General Filters -->
            <div class="filter-group">
                <h4 class="filter-group-title">Filtres G√©n√©raux</h4>

                <!-- Academic Year -->
                <div class="filter-item">
                    <label class="filter-label">Ann√©e Acad√©mique</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.academicYear">
                        <option value="">Toutes les ann√©es</option>
                        <option *ngFor="let year of incomeFilterOptions?.academicYears" [value]="year">
                            {{ year }}
                        </option>
                    </select>
                </div>

                <!-- Date Range -->
                <div class="filter-item">
                    <label class="filter-label">Date de d√©but</label>
                    <input type="date" class="filter-input" [(ngModel)]="activeFilters.startDate">
                </div>

                <div class="filter-item">
                    <label class="filter-label">Date de fin</label>
                    <input type="date" class="filter-input" [(ngModel)]="activeFilters.endDate">
                </div>
            </div>

            <!-- Income Filters -->
            <div class="filter-group">
                <h4 class="filter-group-title">Filtres Revenus</h4>

                <!-- Grade -->
                <div class="filter-item">
                    <label class="filter-label">Niveau</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.grade">
                        <option value="">Tous les niveaux</option>
                        <option *ngFor="let grade of incomeFilterOptions?.grades" [value]="grade">
                            {{ grade }}
                        </option>
                    </select>
                </div>

                <!-- Component -->
                <div class="filter-item">
                    <label class="filter-label">Composant</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.component">
                        <option *ngFor="let comp of components" [value]="comp.value">
                            {{ comp.label }}
                        </option>
                    </select>
                </div>

                <!-- Category -->
                <div class="filter-item">
                    <label class="filter-label">Cat√©gorie</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.category">
                        <option *ngFor="let cat of categories" [value]="cat.value">
                            {{ cat.label }}
                        </option>
                    </select>
                </div>
            </div>

            <!-- Outcome Filters -->
            <div class="filter-group">
                <h4 class="filter-group-title">Filtres D√©penses</h4>

                <!-- User Role -->
                <div class="filter-item">
                    <label class="filter-label">R√¥le Utilisateur</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.userRole">
                        <option value="">Tous les r√¥les</option>
                        <option *ngFor="let role of outcomeFilterOptions?.userRoles" [value]="role">
                            {{ getRoleDisplayName(role) }}
                        </option>
                    </select>
                </div>

                <!-- Charge Category -->
                <div class="filter-item">
                    <label class="filter-label">Cat√©gorie de Charge</label>
                    <select class="filter-select" [(ngModel)]="activeFilters.chargeCategory">
                        <option value="">Toutes les cat√©gories</option>
                        <option *ngFor="let category of outcomeFilterOptions?.chargeCategories" [value]="category">
                            {{ category }}
                        </option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Export Actions Section -->
    <section class="export-actions-section">
        <div class="export-actions-header">
            <h3 class="export-title">
                <span class="export-icon">üì•</span>
                Actions d'Export
            </h3>
            <p class="export-description">
                T√©l√©chargez votre analyse financi√®re compl√®te dans le format de votre choix
            </p>
        </div>

        <div class="export-buttons">
            <button class="btn-export btn-export-excel" (click)="exportToExcel()" [disabled]="isLoading"
                [class.loading]="isLoading">
                <div class="btn-icon-wrapper">
                    <span class="btn-icon" *ngIf="!isLoading">üìä</span>
                    <span class="btn-loading" *ngIf="isLoading">‚è≥</span>
                </div>
                <div class="btn-content">
                    <span class="btn-title">Export Excel</span>
                    <span class="btn-description">Fichier Excel d√©taill√© avec tous les onglets</span>
                </div>
            </button>

            <button class="btn-export btn-export-pdf" (click)="exportToPDF()" [disabled]="isLoading"
                [class.loading]="isLoading">
                <div class="btn-icon-wrapper">
                    <span class="btn-icon" *ngIf="!isLoading">üìÑ</span>
                    <span class="btn-loading" *ngIf="isLoading">‚è≥</span>
                </div>
                <div class="btn-content">
                    <span class="btn-title">Export PDF</span>
                    <span class="btn-description">Rapport PDF avec r√©sum√© financier</span>
                </div>
            </button>
        </div>
    </section>

    <!-- Active Filters Preview -->
    <section class="active-filters-section" *ngIf="hasActiveFilters()">
        <div class="active-filters-header">
            <h4 class="active-filters-title">Filtres Actifs</h4>
        </div>
        <div class="active-filters-list">
            <div class="filter-tag" *ngIf="activeFilters.academicYear">
                <span class="filter-tag-label">Ann√©e:</span>
                <span class="filter-tag-value">{{ activeFilters.academicYear }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.startDate">
                <span class="filter-tag-label">Du:</span>
                <span class="filter-tag-value">{{ formatDate(activeFilters.startDate) }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.endDate">
                <span class="filter-tag-label">Au:</span>
                <span class="filter-tag-value">{{ formatDate(activeFilters.endDate) }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.grade">
                <span class="filter-tag-label">Niveau:</span>
                <span class="filter-tag-value">{{ activeFilters.grade }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.component">
                <span class="filter-tag-label">Composant:</span>
                <span class="filter-tag-value">{{ getComponentDisplayName(activeFilters.component) }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.category">
                <span class="filter-tag-label">Cat√©gorie:</span>
                <span class="filter-tag-value">{{ getCategoryDisplayName(activeFilters.category) }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.userRole">
                <span class="filter-tag-label">R√¥le:</span>
                <span class="filter-tag-value">{{ getRoleDisplayName(activeFilters.userRole) }}</span>
            </div>
            <div class="filter-tag" *ngIf="activeFilters.chargeCategory">
                <span class="filter-tag-label">Charge:</span>
                <span class="filter-tag-value">{{ activeFilters.chargeCategory }}</span>
            </div>
        </div>
    </section>

    <!-- Information Section -->
    <section class="info-section">
        <div class="info-card">
            <div class="info-header">
                <span class="info-icon">‚ÑπÔ∏è</span>
                <h4 class="info-title">√Ä propos de l'Export Combin√©</h4>
            </div>
            <div class="info-content">
                <p>L'export combin√© vous permet de t√©l√©charger une analyse financi√®re compl√®te incluant :</p>
                <ul class="info-list">
                    <li>‚úÖ Analyse d√©taill√©e des revenus (par composant, niveau, √©tudiant)</li>
                    <li>‚úÖ Analyse des d√©penses (charges et salaires)</li>
                    <li>‚úÖ R√©sum√© financier global avec calcul de la marge</li>
                    <li>‚úÖ Tendances mensuelles et comparaisons</li>
                    <li>‚úÖ Tous les filtres appliqu√©s sont respect√©s</li>
                </ul>
                <p class="info-note">
                    <strong>Format Excel :</strong> Plusieurs onglets avec donn√©es d√©taill√©es<br>
                    <strong>Format PDF :</strong> Rapport de synth√®se avec graphiques
                </p>
            </div>
        </div>
    </section>
</div>